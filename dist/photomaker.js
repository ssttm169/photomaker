#!/usr/bin/env node
import{b as t,_ as e,a as r,c as i,m as n}from"./vendor-5fff49e8.js";import o from"path";import{P as a,m as u,c as s,p as c,a as p}from"./vuepress-de19a72c.js";import{glob as l}from"glob";import f from"fs";import"sharp";var v=function(p){var n,o,d,m,v=p.ext,v=void 0===v?a.ext:v,h=p.input,b=void 0===h?"":h,x=p.output,w=p.webp,h=(f.existsSync(x)&&f.rmSync(x,{recursive:!0}),u(x),l.sync("".concat(b,"/**/*.{").concat(v,"}"),{matchBase:!0})),g=(n=(v={files:h,output:x,input:b}).output,o=v.input,d=[],v.files.forEach(function(t){t=t.substring(0,t.lastIndexOf("/")+1);d.push(t.replace(o.replace("./",""),n.replace("./","")))}),(d=(d=Array.from(new Set(t(d)))).filter(function(t){return t})).forEach(function(t){return u(t)}),[]);h.forEach((m=e(r().mark(function t(e){var a,n,u,o,l;return r().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.substring(e.lastIndexOf("/"),e.length).substring(1),n=c({webp:w,fullFileName:a})){t.next=4;break}return t.abrupt("return");case 4:u=null==e||null==(u=e.replace(b.replace("./",""),""))?void 0:u.replace(a,""),o="".concat(x).concat(u).concat(n),l=e.substring(e.lastIndexOf(".")+1,e.length),g.push(s(i(i({},p),{},{input:e,output:o,executeExt:l}))),Promise.allSettled(g);case 9:case"end":return t.stop()}},t)})),function(t){return m.apply(this,arguments)}))},d=n(process.argv.slice(2))||{},m=d.i,h=d.o,b=d.e,x=d.p,y=d.q,w=d.w,g=d.h,S=d.f,z=d.b,q=i({},a);!function(){var t,e,r={input:m,output:h||".".concat(a.storePath),ext:b||a.ext,webp:x||a.webp,quality:y||a.quality},n=((w||g)&&(r.resize={},w&&(r.resize.width=w),g&&(r.resize.height=g),S&&(r.resize.fit=S),z)&&(r.resize.background=z),o.resolve(o.join(process.cwd(),"pmConfig.json")));if(f.existsSync(n)){try{e=JSON.parse(""+f.readFileSync(n))}catch(t){}e&&(r={input:null==(n=e)?void 0:n.input,output:(null==(n=e)?void 0:n.output)||".".concat(a.storePath),ext:(null==(n=e)?void 0:n.ext)||a.ext,webp:(null==(n=e)?void 0:n.webp)||a.webp,resize:(null==(n=e)?void 0:n.resize)||{},quality:(null==(n=e)?void 0:n.quality)||a.quality})}null!=(t=r)&&t.input&&null!=(e=r)&&e.output&&f.existsSync(null==(n=r)?void 0:n.input)&&(e=i(i({},q),r),e=p(e),v(e))}();
